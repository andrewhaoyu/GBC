{
    "collab_server" : "",
    "contents" : "library(ggplot2)\nsetwd(\"../data\")\npheno <- read.table(\"pheno_ev\",header=T,sep=\"\\t\")\n\n\n\nlibrary(ggplot2);library(RColorBrewer);library(gridExtra)\npalette <- brewer.pal(\"Blues\", n=9)\ncolor.background = palette[1]\ncolor.grid.major = palette[3]\ncolor.axis.text = palette[6]\ncolor.axis.title = palette[7]\ncolor.title = palette[9]\nfte_theme <- function() {\n  \n  # Generate the colors for the chart procedurally with RColorBrewer\n  palette <- brewer.pal(\"Greys\", n=9)\n  color.background = palette[2]\n  color.background = \"white\"\n  color.grid.major = palette[3]\n  color.axis.text = palette[6]\n  color.axis.title = palette[7]\n  color.title = palette[9]\n  \n  # Begin construction of chart\n  theme_bw(base_size=9) +\n    \n    # Set the entire chart region to a light gray color\n    theme(panel.background=element_rect(fill=color.background, color=color.background)) +\n    theme(plot.background=element_rect(fill=color.background, color=color.background)) +\n    theme(panel.border=element_rect(color=color.background)) +\n    \n    # Format the grid\n    theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n    theme(panel.grid.minor=element_blank()) +\n    theme(axis.ticks=element_blank()) +\n    \n    # Format the legend, but hide by default\n    theme(legend.background = element_rect(fill=color.background)) +\n    theme(legend.text = element_text(size=7,color=color.axis.title)) +\n    \n    # Set title and axis labels, and format these and tick marks\n    theme(plot.title=element_text(color=color.title, size=10, vjust=1.25)) +\n    theme(axis.text.x=element_text(size=7,color=color.axis.text)) +\n    theme(axis.text.y=element_text(size=7,color=color.axis.text)) +\n    theme(axis.title.x=element_text(size=8,color=color.axis.title, vjust=0)) +\n    theme(axis.title.y=element_text(size=8,color=color.axis.title, vjust=1.25)) +\n    \n    # Plot margins\n    theme(plot.margin = unit(c(0.35, 0.2, 0.3, 0.35), \"cm\"))\n}\ntheme_Publication <- function(base_size=14, base_family=\"\") {\n  library(grid)\n  library(ggthemes)\n  (theme_foundation(base_size=base_size, base_family=base_family)\n    + theme(plot.title = element_text(face = \"bold\",\n                                      size = rel(1.2),hjust=0.5),\n            text = element_text(),\n            panel.background = element_rect(colour = NA),\n            plot.background = element_rect(colour = NA),\n            panel.border = element_rect(colour = NA),\n            axis.title = element_text(face = \"bold\",size = rel(1.0),hjust = 0.5),\n            axis.title.y = element_text(angle=90,vjust =2),\n            axis.title.x = element_text(vjust = -0.2),\n            axis.text = element_text(), \n            axis.line = element_line(colour=\"black\"),\n            axis.ticks = element_line(),\n            panel.grid.major = element_line(colour=\"#f0f0f0\"),\n            panel.grid.minor = element_blank(),\n            legend.key = element_rect(colour = NA),\n            legend.position = \"bottom\",\n            legend.direction = \"horizontal\",\n            legend.key.size= unit(0.2, \"cm\"),\n            legend.margin = unit(0, \"cm\"),\n            legend.title = element_text(face=\"italic\"),\n            #plot.margin=unit(c(10,5,5,5),\"mm\"),\n            #strip.background=element_rect(colour=\"#f0f0f0\",fill=\"#f0f0f0\"),\n            #strip.text = element_text(face=\"bold\")\n    ))\n  \n}\n\nscale_fill_Publication <- function(...){\n  library(scales)\n  discrete_scale(\"fill\",\"Publication\",manual_pal(values = c(\"#386cb0\",\"#fdb462\",\"#7fc97f\",\"#ef3b2c\",\"#662506\",\"#a6cee3\",\"#fb9a99\",\"#984ea3\",\"#ffff33\")), ...)\n  \n}\n\nscale_colour_Publication <- function(...){\n  library(scales)\n  discrete_scale(\"colour\",\"Publication\",manual_pal(values = c(\"#386cb0\",\"#fdb462\",\"#7fc97f\",\"#ef3b2c\",\"#662506\",\"#a6cee3\",\"#fb9a99\",\"#984ea3\",\"#ffff33\")), ...)\n  \n}\n\n\n\nEV <- pheno[,c(28,20,21,22,25,26)]\nbirth_region <- rep(nrow(EV),0)\nbs <- pheno$birth_state\nNorthregion <- c(\"Bihar\",\"DELHI\",\"Uttar Pradesh\",\"Haryana\",\"Himachal Pradesh\",\"Jammu & Kashmir\",\"Punjab\",\"Rajasthan\",\n\"Uttarakhand\",\"Utter Pradsh\")\nNorthregion_id <- bs%in%Northregion\nbirth_region[Northregion_id] <- \"North\"\nNorthEast <- c(\"Arunchal Pradesh\", \"Assam\", \"Meghalaya\", \"Nagaland\", \"Manipur\", \"Tripura\", \"Mizoram\", \"Sikkim\", \"West Bengal\", \"Jharkhand\",\"Orissa\")\nNorthEast_id <- bs%in%NorthEast\nbirth_region[NorthEast_id] <- \"North East\"\nWest <- c(\"Goa\", \"Gujrat\", \"Maharashtra\")\nWest_id <- bs%in%West\nbirth_region[West_id] <- \"West\"\nSouth <- c(\"Andhra Pradesh\", \"Karnataka\", \"Kerala\", \"Andaman &Nicobar islands\", \"Pondicherry\",\"Tamil Nadu\")\nSouth_id <- bs%in%South\nbirth_region[South_id] <- \"South\"\nCentral <- c(\"Madhya Pradesh\",\"Chhattisgarh\")\nCentral_id <- bs%in%Central\nbirth_region[Central_id] <- \"Central\"\nidx.na <- is.na(birth_region)\nbs[idx.na]\ntable(bs[idx.na])\nEV <- cbind(EV,birth_region)\ncolnames(EV)\ncolnames(EV)[1] <- \"Disease Status\"\ncolnames(EV)[7] <- \"Birth Region\"\nEV <- EV[!is.na(EV$`Birth Region`),]\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV3_EV4.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV3,EV4))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n   theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n   theme(panel.grid.minor=element_blank()) +\n   theme(axis.ticks=element_blank()) +\n   theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n   theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n   theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n   theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n   theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n   scale_fill_brewer(palette=\"Blues\",direction = -1)+\n   theme(legend.title =element_text(size=13,face=\"bold\") )+\n   theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV3_EV5.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV3,EV5))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV3_EV8.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV3,EV8))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV3_EV9.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV3,EV9))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV4_EV5.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV4,EV5))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV4_EV8.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV4,EV8))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV4_EV9.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV4,EV9))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV5_EV8.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV5,EV8))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV5_EV9.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV5,EV9))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n\npng(\"/Users/haoyuzhang/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/EV_plot/EV8_EV9.png\",width = 7.635,height =4.7175,units = \"in\",res = 600)\nggplot(EV,aes(colour=`Birth Region`,shape=`Disease Status`))+\n  geom_point(aes(EV8,EV9))+\n  fte_theme()+\n  geom_hline(yintercept=-0.2, size=0.4, color=\"black\")+\n  theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +\n  theme(panel.grid.minor=element_blank()) +\n  theme(axis.ticks=element_blank()) +\n  theme(plot.title=element_text( size=11, vjust=0.5,hjust = 0.5,face=\"bold\")) +\n  theme(axis.text.x=element_text(size=13,face=\"bold\")) +\n  theme(axis.text.y=element_text(size=13,face=\"bold\")) +\n  theme(axis.title.x=element_text(size=13, face=\"bold\",vjust=0)) +\n  theme(axis.title.y=element_text(size=13, face=\"bold\",vjust=1.25))+\n  scale_fill_brewer(palette=\"Blues\",direction = -1)+\n  theme(legend.title =element_text(size=13,face=\"bold\") )+\n  theme(legend.text = element_text(size=13,face=\"bold\"))\ndev.off()\n# theme -------------------------------------------------------------------\n\n# sectionII ---------------------------------------------------------------\n\n\n\n",
    "created" : 1488514373622.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "347518967",
    "id" : "F255C2FC",
    "lastKnownWriteTime" : 1488560465,
    "last_content_update" : 1488560465307,
    "path" : "~/Dropbox/project/Nilanjan/Gallballadar_Cancer/data/evplot.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}